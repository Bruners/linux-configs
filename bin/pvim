#!/bin/bash
#
# A simple script to quickly open Paludis .conf files
#

# Check if running as root, call sudo if not
VIMCMD="vim"
if [ "$(whoami)" != "root" ]; then
    VIMCMD="sudo $VIMCMD"
fi

# Exherbo or gentoo configuration
DIST="exherbo"

# Short names, full names and paths to .conf files
UNMASK="u"
UNMASK_F="unmask"
PATH_UNMASK="/etc/paludis/package_unmask.conf"

MASK="m"
MASK_F="mask"
PATH_MASK="/etc/paludis/package_mask.conf"

GENERAL="g"
GENERAL_F="general"
PATH_GENERAL="/etc/paludis/general.conf"

BASHRC="b"
BASHRC_F="bashrc"
PATH_BASHRC="/etc/paludis/bashrc"

LICENCES="l"
LICENCES_F="licences"
PATH_LICENCES="/etc/paludis/licences.conf"

HELP="-h"
HELP_F="--help"

# Gentoo and Exherbo got some differences
if [ "$DIST" = 'exherbo' ]; then
    PLATFORMS="p"
    PLATFORMS_F="platforms"
    PATH_PLATFORMS="/etc/paludis/platforms.conf"

    OPTIONS="o"
    OPTIONS_F="options"
    PATH_OPTIONS="/etc/paludis/options.conf"

    LICENCES="l"
    LICENCES_F="licences"
    PATH_LICENCES="/etc/paludis/licences.conf"
fi

if [ "$DIST" = 'gentoo' ]; then
    PLATFORMS="k"
    PLATFORMS_F="keywords"
    PATH_PLATFORMS="/etc/paludis/keywords.conf"

    OPTIONS="o"
    OPTIONS_F="use"
    PATH_OPTIONS="/etc/paludis/use.conf"

    LICENCES="l"
    LICENCES_F="licenses"
    PATH_LICENCES="/etc/paludis/licenses.conf"
fi

# Set default colours, adapted from eclectic
COLOUR_HI="\033[1;34m"
COLOUR_NORMAL="\033[00m"
COLOUR_WARN="\033[1;31m"

# Display some info on how to use
function helptext {
    echo -e $COLOUR_HI"Usage: pvim option\n\nValid options are:"
    echo -e $COLOUR_HI"${GENERAL} / ${GENERAL_F}"$COLOUR_NORMAL" - opens ${PATH_GENERAL}"
    echo -e $COLOUR_HI"${UNMASK} / ${UNMASK_F}"$COLOUR_NORMAL" - opens ${PATH_UNMASK}"
    echo -e $COLOUR_HI"${MASK} / ${MASK_F}"$COLOUR_NORMAL" - opens ${PATH_MASK}"
    echo -e $COLOUR_HI"${PLATFORMS} / ${PLATFORMS_F}"$COLOUR_NORMAL" = opens ${PATH_PLATFORMS}"
    echo -e $COLOUR_HI"${OPTIONS} / ${OPTIONS_F}"$COLOUR_NORMAL" = opens ${PATH_OPTIONS}"
    echo -e $COLOUR_HI"${BASHRC} / ${BASHRC_F}"$COLOUR_NORMAL" = opens ${PATH_BASHRC}"
    echo -e $COLOUR_HI"${LICENCES} / ${LICENCES_F}"$COLOUR_NORMAL" = opens ${PATH_LICENCES}"
    echo ""
    echo -e $COLOUR_HI"${HELP} / ${HELP_F}"$COLOUR_NORMAL" = shows help information"
}

case "$1" in
    "")
        helptext
        ;;
    $GENERAL|$GENERAL_F)
        $VIMCMD $PATH_GENERAL
        ;;
    $UNMASK|$UNMASK_F)
        $VIMCMD $PATH_UNMASK
        ;;
    $MASK|$UNMASK_F)
        $VIMCMD $PATH_MASK
        ;;
    $PLATFORMS|$PLATFORMS_F)
        $VIMCMD $PATH_PLATFORMS
        ;;
    $OPTIONS|$OPTIONS_F)
        $VIMCMD $PATH_OPTIONS
        ;;
    $BASHRC|$BASHRC_F)
        $VIMCMD $PATH_BASHRC
        ;;
    $LICENCES|$LICENCES_F)
        $VIMCMD $PATH_LICENCES
        ;;
    $HELP|$HELP_F)
        helptext
        ;;
    *)
        echo -e $COLOUR_WARN"Unrecognized option"
        helptext
        ;;
esac
exit 0
