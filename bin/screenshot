#!/bin/bash

DIR="${HOME}/Pictures/scrot"
DATE="$(date +%Y-%m-%d@%H.%M.%S)"
NAME="${DIR}/${DATE}.jpg"
LOG="${DIR}/screenshots.log"

WARNING=red
NORMAL=white
HILIGHT=yellow

# 1-100
QUALITY="95"

RUN="/usr/bin/import -quality ${QUALITY}"

if [ 'pkg-config libaosd' ]; then
    OSD="/usr/bin/aosd_cat -n 'sans 20 bold' -o 3000 -R -f 300 -u 1000 -o 1000 -x -800 -y 1 -p 1 -t 0 "
else
    OSD=""
fi

function write_log {
        feh $NAME &
        echo -e "Saving screenshot to ${NAME}" | $OSD -R $HILIGHT &
        echo -e "${NAME}" >> $LOG &
}

# Check if the dir to store the screenshots exists, else create it:
if [ ! -d "$DIR" ]; then
    mkdir -p $DIR
fi

function error {
    # Display a warning if no area defined
    echo -e "No zone selected.^MMm+Scr = Entire screen^MMm+Sm+Scr = Window or area" | $OSD -l 3 -R $WARNING
}

case "$1" in
    "win")
        $RUN $NAME
        write_log
        ;;
    "scr")
        $RUN -window root $NAME
        write_log
        ;;
    *)
        error
        ;;
esac

exit 0

